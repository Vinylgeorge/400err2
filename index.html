<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MTurk Queue</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #fafafa; }
    table { border-collapse: collapse; width: 100%; margin-top: 10px; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    th { background: #333; color: #fff; }
    tr:nth-child(even) { background: #f9f9f9; }
    h2 { margin-bottom: 10px; }
  </style>
</head>
<body>

<h2 id="queue-header">Your HITs Queue (0)</h2>

<table>
  <thead>
    <tr>
      <th>Requester</th>
      <th>Title</th>
      <th>Reward</th>
      <th>Worker ID</th>
      <th>Time Remaining</th>
      <th>Accepted At</th>
    </tr>
  </thead>
  <tbody id="queue-body">
    <!-- Rows will be injected here -->
  </tbody>
</table>

<script>
  const binId = "68c89a4fd0ea881f407f25c0"; // üîë your bin ID
  const apiKey = "$2a$10$tGWSdPOsZbt7ecxcUqPwaOPrtBrw84TrZQDZtPvWN5Hpm595sHtUm"; // üîë your API key
  const url = `https://api.jsonbin.io/v3/b/${binId}/latest`;

  function formatTimeRemaining(seconds) {
    const m = Math.floor(seconds / 60);
    const s = seconds % 60;
    return `${m}m ${s}s`;
  }

  async function loadQueue() {
    try {
      const res = await fetch(url, {
        headers: { "X-Master-Key": apiKey }
      });
      const data = await res.json();
      const hits = data.record || [];

      const tbody = document.getElementById("queue-body");
      const header = document.getElementById("queue-header");

      tbody.innerHTML = ""; // clear old rows

      hits.forEach(hit => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${hit.requester}</td>
          <td>${hit.title}</td>
          <td>$${hit.reward}</td>
          <td>${hit.workerId}</td>
          <td>${formatTimeRemaining(hit.timeRemainingSeconds || 0)}</td>
          <td>${new Date(hit.acceptedAt || hit.time).toLocaleString()}</td>
        `;
        tbody.appendChild(tr);
      });

      header.textContent = `Your HITs Queue (${hits.length})`;
    } catch (err) {
      console.error("‚ùå Error loading queue:", err);
    }
  }

  // Initial load + refresh every 10s
  loadQueue();
  setInterval(loadQueue, 10000);
</script>

</body>
</html>
