<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>AB2soft Global Controller</title>
  <style>
    body { font-family: Arial; background:#f8f9fa; padding:40px; }
    input, button { padding:10px; margin:6px 0; font-size:15px; width:100%; }
    button { cursor:pointer; background:#0f62fe; color:white; border:none; border-radius:6px; }
    button.stop { background:#dc2626; }
  </style>
</head>
<body>
  <h2>AB2soft Global HIT Controller</h2>
  <input id="req" placeholder="Requester ID (e.g. A15ZSKX8TUCGEU)">
  <input id="limit" type="number" placeholder="Number of HITs (e.g. 5)" value="5">
  <button id="start">Start</button>
  <button id="stop" class="stop">Stop</button>
  <p id="msg"></p>

  <script>
    const CONTROL_URL = "https://aqua-theo-29.tiiny.site/protected/control.json"; // your hosted control.json

    async function update(active, requester, limit = 5) {
      const body = JSON.stringify({ active, requester_id: requester, limit });
      await fetch(CONTROL_URL, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body
      });
      document.getElementById('msg').innerText = active
        ? `✅ Started for ${requester}`
        : `⏹️ Stopped`;
    }

    document.getElementById("start").onclick = () => {
      const id = document.getElementById("req").value.trim();
      const lim = parseInt(document.getElementById("limit").value || 5);
      if (!id) return alert("Enter requester ID!");
      update(true, id, lim);
    };

    document.getElementById("stop").onclick = () => update(false, "", 0);
  </script>
</body>
</html>
